---
title: "R-loop comparison"
author: "Aiola Stoja"
date: "2023-11-16"
output: html_document
---

```{r setup packages, include=FALSE}

library(readxl)
library(tidyr)
library(dplyr)
library(VennDiagram)
library(devtools)
#install_github("wjawaid/enrichR")
library(enrichR)
library(ggpubr)
library(kableExtra)
library(eulerr)
library(purrr)


```


```{r readin table}

my_data <- as.list(read_xlsx("tables1_Helicases_in_R-loop_Formation_and_Resolution.xlsx")) 

my_data_names<- sapply(my_data,'[[',1)

names(my_data) <- c(my_data_names[[1]], my_data_names[[2]], my_data_names[[3]], my_data_names[[4]], my_data_names[[5]], my_data_names[[6]])


#%>%
 #map(function(a) a[-1]) 

#naomit_mydata <- lapply(my_data, function(x) x[!is.na(x)]) %>%
 # map(function(a) a[-1]) 


naomit_mydata_semicolonseperated <- my_data %>%
  map(function(v) v[-1]) %>%
  map(function(w) w[!is.na(w)]) %>%
  map(function(x) strsplit(as.character(x), ";")) %>%
  map(function(y) unlist(y)) %>%
  map(function(z) unique(z)) 


```
```{r venn diagram of rnaseH comparison and s9.6 comparison seperately, echo=FALSE}

genes.venn_rnaseH <- euler(c(naomit_mydata_semicolonseperated[4], naomit_mydata_semicolonseperated[5]))
genes.venn_s9.6 <- euler(c(naomit_mydata_semicolonseperated[1], naomit_mydata_semicolonseperated[3]))
plot(genes.venn_rnaseH, quantities = TRUE, count = TRUE)
plot(genes.venn_s9.6, quantities = TRUE, count = TRUE)

VennPartition<-get.venn.partitions(c(naomit_mydata_semicolonseperated[4], naomit_mydata_semicolonseperated[5], 
                                     naomit_mydata_semicolonseperated[1], naomit_mydata_semicolonseperated[3])) %>% dplyr::as_tibble()


listVennPartition <- setNames(as.list(VennPartition$..values..), VennPartition$..set..)





```

```{r venn diagram for all rnaseh combined and all s9.6 combined, echo=FALSE}

rnaseh_combined <- mapply(c, naomit_mydata_semicolonseperated[4], naomit_mydata_semicolonseperated[5]) %>%
  unique() #if you want to see which are duplicated, you can do duplicated()
s9.6_combined <- mapply(c, naomit_mydata_semicolonseperated[1], naomit_mydata_semicolonseperated[3]) %>%
  unique()

combined_list <- list(rnaseh_combined, s9.6_combined)

names(combined_list) <- c("rnaseh_combined", "s9.6_combined")

genes.venn_combined <- euler(combined_list)
plot(genes.venn_combined, quantities = TRUE)





plot(genes.venn_rnaseH, quantities = TRUE, count = TRUE)
plot(genes.venn_s9.6, quantities = TRUE, count = TRUE)

VennPartition<-get.venn.partitions(c(naomit_mydata_semicolonseperated[4], naomit_mydata_semicolonseperated[5], 
                                     naomit_mydata_semicolonseperated[1], naomit_mydata_semicolonseperated[3])) %>% dplyr::as_tibble()


listVennPartition <- setNames(as.list(VennPartition$..values..), VennPartition$..set..)





```

