---
title: "R-loop comparison"
author: "Aiola Stoja"
date: "2023-11-16"
output: html_document
---

```{r setup packages, include=FALSE}

library(readxl)
library(tidyr)
library(dplyr)
library(VennDiagram)
library(devtools)
#install_github("wjawaid/enrichR")
library(enrichR)
library(ggpubr)
library(kableExtra)
library(eulerr)
library(purrr)


```


```{r readin table}

my_data <- as.list(read_xlsx("tables1_Helicases_in_R-loop_Formation_and_Resolution.xlsx")) 

my_data_names<- sapply(my_data,'[[',1)

names(my_data) <- c(my_data_names[[1]], my_data_names[[2]], my_data_names[[3]], my_data_names[[4]], my_data_names[[5]], my_data_names[[6]])

my_list <- set_names(my_list, c('label1', 'label2', 'label3'))
imap(my_data_names, ~ set_names(.x, paste(.y, seq_along(.x), sep = ".")))


my_data_names[[1]]

names(my_data)<- my_data_names[[1:6]]

as.data.frame(my_data_names)

names(my_data)

sapply(my_data,'[[',1)

my_data[1]

my_data<- assign(my_data)

#%>%
 #map(function(a) a[-1]) 

naomit_mydata <- lapply(my_data, function(x) x[!is.na(x)])


naomit_mydata_semicolonseperated<-naomit_mydata %>%
  map(function(x) strsplit(as.character(x), ";")) %>%
  map(function(y) unlist(y)) %>%
  map(function(z) unique(z)) 


```


```{r determine whether list is geneID or proteinID, echo=FALSE}

genes.venn <- euler(naomit_mydata_semicolonseperated)
plot(genes.venn, quantities = TRUE)

VennPartition<-get.venn.partitions(naomit_mydata) %>% dplyr::as_tibble()


listVennPartition <- setNames(as.list(VennPartition$..values..), VennPartition$..set..)





```

